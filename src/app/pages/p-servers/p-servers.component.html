<div class="flex flex-col justify-between h-full overflow-hidden">

    <div class="flex-grow h-1 px-6 overflow-y-scroll shrink-0">
        <div class="flex flex-row space-x-2">
            <!-- <app-btn-comp (btn_func)="get_clients()" btn_str="Get all connection"></app-btn-comp> -->
            <app-btn-comp (btn_func)="get_storage_all()" btn_str="Get all storage"></app-btn-comp>
        </div>

        <div class="py-2"></div>

        <div class="border rounded-md border-gray-300 w-fit">

            <table class="table-fixed text-nowrap w-fit">
                <thead class="divide-y border-b-gray-300 border-b text-sm">
                    <tr>
                        <th class="w-[40px] border-slate-500 font-medium py-2">No</th>
                        <th class="w-[200px] border-x border-gray-300 font-medium">Client ID</th>
                        <th class="w-[200px] border-x border-gray-300 font-medium">Overall Storage</th>
                        <th class="w-[150px] border-x border-gray-300 font-medium border-r-0">CPU Usage</th>
                        <th class="w-[180px] border-x border-gray-300 font-medium border-r-0">RAM Usage</th>
                        <th class="w-[150px] border-x border-gray-300 font-medium border-r-0">Uptime</th>
                    </tr>
                </thead>

                <tbody class="text-xs">
                    <tr *ngFor="let item of arr_connection, index as i" (click)="set_act_server(item['device_id'])"
                        [ngClass]="{'bg-blue-500/10':item['device_id'] == act_server}">


                        <td class="border-x px-3 border-gray-300 border-l-0 ">
                            <p class="flex py-2 justify-center">{{ i+1 }}</p>
                        </td>


                        <td class="border-x px-3 border-gray-300">
                            <p class=""> {{item['device_id']}}</p>
                        </td>


                        <td class="border-x px-3 border-gray-300">
                            <div class="w-full flex justify-center items-center flex-col text-xs">
                                <div *ngIf="item['summary_storage'] == null">
                                    <p>Null</p>
                                </div>

                                <div *ngIf="item['summary_storage'] != null"
                                    class="w-full flex justify-center items-center flex-col">
                                    <p>{{get_overall_storage(item['summary_storage'])}}%</p>

                                    <div class="w-[90%] h-2 bg-gray-200 rounded-full overflow-hidden">
                                        <div [style.width.%]="item['summary_storage']" [class]="'bg-blue-500 h-2'">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>


                        <td class="border-x">
                            <div *ngIf="item['server_info'] != null"
                                class="w-full flex justify-center flex-col items-center space-y-0.5">


                                <p class="">{{item['server_info']['cpu']['cpu_usage']}}%</p>

                                <div class="w-[90%] h-1 bg-gray-200 rounded-full overflow-hidden">
                                    <div [style.width.%]="item['server_info']['cpu']['cpu_usage']"
                                        [class]="'bg-blue-500 h-1'">
                                    </div>
                                </div>
                            </div>
                        </td>


                        <td class="border-x">
                            <div *ngIf="item['server_info'] != null"
                                class="w-full flex justify-center flex-col items-center space-y-0.5 text-[12px]">

                                <div class="flex flex-row space-x-1">
                                    <p class="">{{get_ram_usage(item['server_info']['mem'])}}%</p>
                                    <p>{{get_ram_info(item['server_info']['mem'])}}</p>
                                </div>

                                <div class="w-[90%] h-1 bg-gray-200 rounded-full overflow-hidden">
                                    <div [style.width.%]="get_ram_usage(item['server_info']['mem'])"
                                        [class]="'bg-blue-500 h-1'">
                                    </div>
                                </div>
                            </div>
                        </td>


                        <td class="border-x border-r-0">
                            <div *ngIf="item['server_info'] != null"
                                class="w-full flex justify-center flex-col items-center space-y-0.5 text-[12px]">

                                <div class="flex flex-row">
                                    <p class="">{{(item['server_info']['uptime'])}}</p>
                                </div>
                            </div>
                        </td>

                    </tr>
                </tbody>
            </table>
        </div>

        <div class="my-20"></div>

    </div>

    <div [ngClass]="{'h-[75lvh]':bool_detail_expand}" *ngIf="act_server != null"
        class="h-[50lvh] border-t border-gray-800 w-full relative transition-all">
        <div class="h-full overflow-y-scroll">
            <button class="absolute right-[50%] translate-y-[-50%] bg-white p-1 rounded-md px-6 border border-gray-300 "
                (click)="expand_detail()">Expand</button>
            <div *ngIf="act_server != null">
                <app-c-server-storage [attr.key]="act_server" [inp_device_id]="act_server"></app-c-server-storage>
            </div>

            <div class="py-10"></div>
        </div>

    </div>


</div>